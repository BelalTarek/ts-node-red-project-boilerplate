[{"id":"d404091c.51afb8","type":"tab","label":"Flow 1","disabled":false,"info":""},{"id":"90ac7a48.64b938","type":"tab","label":"Flow 2","disabled":false,"info":""},{"id":"54c694fe.c72d5c","type":"mongodb-config","z":0,"hostname":"ds261114.mlab.com","port":"61114","db":"ceva","name":"Ceva"},{"id":"eb139b4b.adfa18","type":"mongodb","z":"","hostname":"ds261114.mlab.com","port":"61114","db":"ceva","name":"MongoDB"},{"id":"2ae8cef8.2b6292","type":"function","z":"d404091c.51afb8","name":"header","func":"msg.headers = {\"content-type\": \"application/json\"}\nreturn msg;","outputs":1,"noerr":0,"x":129,"y":343,"wires":[["750b884b.83ae38"]]},{"id":"621a1a01.0c5084","type":"function","z":"d404091c.51afb8","name":"functionBody","func":"if(msg.payload){\n    msg.res.json({\n        succsess: \"true\",\n        data: msg.payload\n    })\n}\nelse{\n    msg.res.json({\n        succsess: \"false\",\n        data: null\n    })\n}","outputs":1,"noerr":0,"x":130.5,"y":230,"wires":[["2ae8cef8.2b6292"]]},{"id":"17e6321a.633c1e","type":"http in","z":"d404091c.51afb8","name":"Http Request","url":"/read","method":"get","upload":false,"swaggerDoc":"","x":77.5,"y":36,"wires":[["87c8889f.060778"]]},{"id":"750b884b.83ae38","type":"http response","z":"d404091c.51afb8","name":"Http Response","statusCode":"200","headers":{},"x":142.5,"y":486,"wires":[]},{"id":"87c8889f.060778","type":"mongodb in","z":"d404091c.51afb8","mongodb":"eb139b4b.adfa18","name":"findQuery-openingBalance","collection":"invoices","operation":"find","x":366,"y":36,"wires":[["1a5d7919.327607"]]},{"id":"1a5d7919.327607","type":"switch","z":"d404091c.51afb8","name":"switch","property":"var","propertyType":"msg","rules":[{"t":"null"},{"t":"nnull"}],"checkall":"true","repair":false,"outputs":2,"x":410,"y":155,"wires":[["f073bada.485518"],["621a1a01.0c5084"]]},{"id":"f7de005c.29544","type":"debug","z":"d404091c.51afb8","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","x":733,"y":371,"wires":[]},{"id":"f073bada.485518","type":"function","z":"d404091c.51afb8","name":"Temp","func":"msg.payload = \"switch casae work\"\nreturn msg;","outputs":1,"noerr":0,"x":729,"y":233,"wires":[["f7de005c.29544"]]},{"id":"5c19ef66.62ef4","type":"http in","z":"90ac7a48.64b938","name":"Http Request","url":"/upload-file","method":"post","upload":true,"swaggerDoc":"","x":98,"y":47,"wires":[["3921440.dfca0bc","5fe8ad62.283fe4"]]},{"id":"b9f89e28.e14c1","type":"mongodb out","z":"90ac7a48.64b938","mongodb":"eb139b4b.adfa18","name":"insertOneningBalancecesSheet","collection":"openingbalances","payonly":true,"upsert":false,"multi":false,"operation":"insert","x":575,"y":47,"wires":[]},{"id":"a1b8d3d4.381f4","type":"http response","z":"90ac7a48.64b938","name":"","statusCode":"","headers":{},"x":786,"y":232,"wires":[]},{"id":"1eb09450.e2bb2c","type":"function","z":"90ac7a48.64b938","name":"","func":"\nreturn msg;","outputs":1,"noerr":0,"x":786,"y":295,"wires":[[]]},{"id":"5fe8ad62.283fe4","type":"debug","z":"90ac7a48.64b938","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":390,"y":200,"wires":[]},{"id":"3921440.dfca0bc","type":"function-npm","z":"90ac7a48.64b938","name":"parsingFile","func":"const XLSX = require('xlsx');\nvar workbook = XLSX.readFile(msg.req.files.file);\nvar sheet_name_list = workbook.SheetNames;\nvar data = XLSX.utils.sheet_to_json(workbook.Sheets[sheet_name_list[0]])\nmsg.payload = data;\nreturn msg;","outputs":1,"noerr":0,"x":309,"y":47,"wires":[["b9f89e28.e14c1"]]}]